var backman=angular.module("backman",["ui.router"]);backman.config(function($httpProvider,$urlRouterProvider,$controllerProvider,$compileProvider,$filterProvider,$provide){"use strict";$httpProvider.defaults.headers.put["Content-Type"]="application/x-www-form-urlencoded",$httpProvider.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",$httpProvider.defaults.headers.post["X-Requested-With"]="XMLHttpRequest",$httpProvider.defaults.headers.get={"X-Requested-With":"XMLHttpRequest"},$httpProvider.defaults.transformRequest=[function(data){var param=function(obj){var name,value,fullSubName,subName,subValue,innerObj,i,query="";for(name in obj)if(obj.hasOwnProperty(name))if(value=obj[name],value instanceof Array)for(i=0;i<value.length;++i)subValue=value[i],fullSubName=name+"["+i+"]",innerObj={},innerObj[fullSubName]=subValue,query+=param(innerObj)+"&";else if(value instanceof Object)for(subName in value)value.hasOwnProperty(subName)&&(subValue=value[subName],fullSubName=name+"."+subName,innerObj={},innerObj[fullSubName]=subValue,query+=param(innerObj)+"&");else void 0!==value&&null!==value&&(query+=encodeURIComponent(name)+"="+encodeURIComponent(value)+"&");return query.length?query.substr(0,query.length-1):query};return angular.isObject(data)&&"[object File]"!==String(data)?param(data):data}],$compileProvider.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|file|sms|javascript):/)}),backman.run(function($rootScope,$state,$stateParams){"use strict";$rootScope.$state=$state,$rootScope.$stateParams=$stateParams}),backman.module=function(name,dependences){"use strict";var app=angular.module(name,["backman"].concat(dependences));return app.config(function($controllerProvider,$compileProvider,$filterProvider,$provide){app.register={controller:$controllerProvider.register,directive:$compileProvider.directive,filter:$filterProvider.register,factory:$provide.factory,service:$provide.service}}),app},backman.factory("_responePreHandler",function(_tools){"use strict";return{success:function(success,config){if(20001!=success.data.state.code||!config||1!=config.noVerify){if(20001==success.data.state.code)return void(window.location.href="/usercenter/login-show");if(10200!=success.data.state.code&&10205!=success.data.state.code)return success.data.data=null,alert(success.msg||success.data&&success.data.state&&success.data.state.msg),null;if(10205==success.data.state.code)return{};var data=success.data.data?_tools.transKeyName("camel",success.data.data):{};return data.__state=success.data.state,data}},error:function(err){return err}}}),backman.factory("_httpPost",function($http,_tools,_responePreHandler,_setting){"use strict";return function(url,postData,config){return config&&config.ajaxParams||angular.extend(postData,_setting.ajaxParams),postData=_tools.transKeyName("underline",postData),$http({method:"POST",url:url,data:postData}).then(function(success){return _responePreHandler.success(success,config)},function(err){return _responePreHandler.error(err)})}}),backman.factory("_httpGet",function($http,_tools,_responePreHandler,_setting){"use strict";return function(url,getData,config){return config&&config.ajaxParams||angular.extend(getData,_setting.ajaxParams),getData=_tools.transKeyName("underline",getData),$http({method:"GET",url:url,params:getData}).then(function(success){return _responePreHandler.success(success,config)},function(err){return _responePreHandler.error(err)})}}),backman.factory("_setting",function($rootScope){"use strict";var _data={base:location.protocol+"//"+location.host,path:"/"+location.pathname.split("/index.html")[0],ajaxParams:null,navListUrl:""};return _data.navListUrl=_data.base+_data.path+"/_data/navList.json",{get:function(key){return _data[key]},set:function(key,val){_data[key]=val}}}),backman.constant("_tools",function(){"use strict";var urlData=null,getUrlParam=function(name){if(!urlData){var url=window.location.href;urlData={};var arr=url.split("?");if(arr.length>1){arr=arr[1].split("&");for(var i=0,l=arr.length;i<l;i++){var a=arr[i].split("=");urlData[a[0]]=a[1]}urlData=transKeyName("camel",urlData)}}return urlData[name]},transKeyName=function(type,json){var toCamel=function(str){var str2="";if(str.indexOf("_")<0)str2=str;else{for(var words=str.split("_"),i=1;i<words.length;i++)words[i]=words[i].substr(0,1).toUpperCase()+words[i].substr(1);str2=words.join("")}return str2},toUnderline=function(str){var str2="";return str2=/[A-Z]/.test(str)?str.replace(/([A-Z])/g,function($1){return"_"+$1.toLowerCase()}):str},transform=function(json,json2){for(var p in json)if(json.hasOwnProperty(p)){var key;"string"==typeof p?"camel"==type?key=toCamel(p):"underline"==type&&(key=toUnderline(p)):key=p,json[p]instanceof Object?json2[key]=transform(json[p],"undefined"==typeof json[p].length?{}:[]):json2[key]=json[p]}return json2};return transform(json,"undefined"==typeof json.length?{}:[])},loadJs=function(jsList){return function($q,$rootScope){var deferred=$q.defer();return $script(jsList,function(){$rootScope.$apply(function(){deferred.resolve()})}),deferred.promise}};return{getUrlParam:getUrlParam,transKeyName:transKeyName,loadJs:loadJs}}()),backman.factory("_validate",function(){"use strict";return{isMobile:function(val){var rgx=/^(13[0-9]|14[0-9]|15[0-9]|18[0-9])\d{8}$/i;return rgx.test($.trim(val))},isRequired:function(val){return!!$.trim(val)},isMatchLength:function(val,len){return $.trim(val).length==len},isLengthInRange:function(val,arr){var len=$.trim(val).length;return len>=arr[0]&&len<=arr[1]},isInRange:function(val,arr){return val>=arr[0]&&val<=arr[1]},isIdCard:function(val){var rgx=/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{4}$/;return rgx.test($.trim(val))},isTheSame:function(val1,val2){return val1==val2},isCorrectPassword:function(val){var rgx=/^(?!\d+$)(?![a-z]+$).+$/i;return rgx.test($.trim(val))}}}),backman.controller("backmanFramework",function($scope,_setting){"use strict";$scope.sidebarOpen=!1,$scope.act={toggleSidebar:function(){$scope.sidebarOpen=!$scope.sidebarOpen}}}),backman.controller("backmanNavigation",function($scope,_setting,_httpGet){"use strict";var getNavData=function(cb,cberr){var apiAddress=_setting.get("navListUrl");_httpGet(apiAddress,{}).then(function(data){if("function"===$.type(cb)){for(var item1,navList=[],i=0;item1=data[i];i++)if(!item1.state&&!item1.hash){if("array"!=$.type(item1.children))item1.children=[];else for(var item2,j=0;item2=item1[j];j++)"array"!=$.type(item2.children)&&(item2.children=[]);navList.push(item1)}cb(navList)}},function(data){"function"===$.type(cberr)&&cberr(data)})},renderNavigation=function(data){data=data.sort(sortNavigation);for(var item,i=0;item=data[i];i++)item.children&&item.children.length&&item.children.sort(sortNavigation);$scope.navData=data},sortNavigation=function(item1,item2){return item1.order>item2.order};getNavData(renderNavigation)}),backman.directive("bmDatepick",function(){"use strict";return{scope:{dateBind:"="},restrict:"A",link:function($scope,iElm,iAttrs){var format=iAttrs.dateFormat||"YYYY-MM-DD hh:mm:ss",timePick=/(hh|mm|ss)+/g.test(format),eid="datepick"+Date.now()%1e7+parseInt(1e3*Math.random());iElm.attr("id",eid).attr("placeholder",format).addClass("laydate-icon").wrap('<div class="layinput"></div>').on("click",function(){var $this=$(this);$this.attr("readonly")||$this[0].dispatchEvent(new MouseEvent("dblclick",{bubbles:!0,cancelable:!0,view:window}))}),laydate({elem:"#"+eid,format:format,istime:timePick,event:"dblclick",choose:function(dates){$scope.dateBind=dates,$scope.$$phase||$scope.$root.$$phase||$scope.$apply()}});var initW=$scope.$watch("dateBind",function(newVal,oldVal){newVal&&(initW(),iElm.val(newVal))})}}}),backman.directive("bmEditor",function(){"use strict";return{scope:{contentBind:"="},restrict:"A",link:function($scope,iElm,iAttrs){var eid="editor"+Date.now()%1e7+parseInt(1e3*Math.random());iElm.attr("id",eid);var editor=KindEditor.create("#"+eid,{items:["source","|","undo","redo","|","template","code","|","cut","copy","paste","plainpaste","wordpaste","|","justifyleft","justifycenter","justifyright","justifyfull","insertorderedlist","insertunorderedlist","indent","outdent","subscript","superscript","clearhtml","quickformat","|","selectall","fullscreen","/","formatblock","fontname","fontsize","|","forecolor","hilitecolor","bold","italic","underline","strikethrough","lineheight","removeformat","|","image","table","hr","emoticons","baidumap","pagebreak","anchor","link","unlink","|","preview","print","about"],width:"100%",height:"270px",resizeMode:1,allowFileManager:!1,imageUploadJson:iAttrs.imageUploadUrl||"",afterChange:function(){editor&&editor.html()&&($scope.contentBind=editor.html(),$scope.$$phase||$scope.$root.$$phase||$scope.$apply())}}),initW=$scope.$watch("contentBind",function(newVal,oldVal){newVal&&(initW(),editor.html(newVal+""))})}}}),backman.directive("bmSidebar",function(){return{scope:!1,restrict:"A",link:function($scope,iElm,iAttrs){iElm.on("click",".treeview-title",function(){var $this=$(this);$this.parent().hasClass("active")?$this.parent().removeClass("active").end().next("ul.treeview-menu").slideUp("fast"):$this.parent().addClass("active").end().next("ul.treeview-menu").slideDown("fast")});var navInitHandler=$scope.$watch("navData",function(newValue,oldValue){if(newValue){navInitHandler();var hash=window.location.hash;setTimeout(function(){iElm.find(".treeview-link").each(function(){var $this=$(this);if($this.attr("href")==hash){var $parent1=$this.parent().parent().show().parent().addClass("active");if($parent1.hasClass("treeview")){var $parent2=$parent1.parent().show().parent().addClass("active");$parent2.hasClass("treeview")&&$parent2.addClass("active")}}})},0)}})}}});
//# sourceMappingURL=backman.min.js.map
